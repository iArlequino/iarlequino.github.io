const navBurger=document.querySelector(".nav__burger"),navMenu=document.querySelector(".nav__menu"),body=document.querySelector("body"),navCart=document.querySelector(".nav__cart-btn"),menuClose=document.querySelector(".menu__close-field"),mediaQuery=window.matchMedia("(max-width: 991px)");function burgerToggle(){navBurger.classList.toggle("active"),setTimeout(()=>{navMenu.classList.toggle("active")},10),navCart.classList.toggle("active"),mediaQuery.matches||body.classList.remove("lock"),mediaQuery.matches&&body.classList.toggle("lock")}function DynamicAdapt(t){this.type=t}navBurger.addEventListener("click",()=>{burgerToggle()}),menuClose.addEventListener("click",()=>{burgerToggle()}),DynamicAdapt.prototype.init=function(){const t=this;this.оbjects=[],this.daClassname="_dynamic_adapt_",this.nodes=document.querySelectorAll("[data-da]");for(let t=0;t<this.nodes.length;t++){const e=this.nodes[t],r=e.dataset.da.trim().split(","),a={};a.element=e,a.parent=e.parentNode,a.destination=document.querySelector(r[0].trim()),a.breakpoint=r[1]?r[1].trim():"767",a.place=r[2]?r[2].trim():"last",a.index=this.indexInParent(a.parent,a.element),this.оbjects.push(a)}this.arraySort(this.оbjects),this.mediaQueries=Array.prototype.map.call(this.оbjects,(function(t){return"("+this.type+"-width: "+t.breakpoint+"px),"+t.breakpoint}),this),this.mediaQueries=Array.prototype.filter.call(this.mediaQueries,(function(t,e,r){return Array.prototype.indexOf.call(r,t)===e}));for(let e=0;e<this.mediaQueries.length;e++){const r=this.mediaQueries[e],a=String.prototype.split.call(r,","),c=window.matchMedia(a[0]),n=a[1],i=Array.prototype.filter.call(this.оbjects,(function(t){return t.breakpoint===n}));c.addListener((function(){t.mediaHandler(c,i)})),this.mediaHandler(c,i)}},DynamicAdapt.prototype.mediaHandler=function(t,e){if(t.matches)for(let t=0;t<e.length;t++){const r=e[t];r.index=this.indexInParent(r.parent,r.element),this.moveTo(r.place,r.element,r.destination)}else for(let t=0;t<e.length;t++){const r=e[t];r.element.classList.contains(this.daClassname)&&this.moveBack(r.parent,r.element,r.index)}},DynamicAdapt.prototype.moveTo=function(t,e,r){e.classList.add(this.daClassname),"last"===t||t>=r.children.length?r.insertAdjacentElement("beforeend",e):"first"!==t?r.children[t].insertAdjacentElement("beforebegin",e):r.insertAdjacentElement("afterbegin",e)},DynamicAdapt.prototype.moveBack=function(t,e,r){e.classList.remove(this.daClassname),void 0!==t.children[r]?t.children[r].insertAdjacentElement("beforebegin",e):t.insertAdjacentElement("beforeend",e)},DynamicAdapt.prototype.indexInParent=function(t,e){const r=Array.prototype.slice.call(t.children);return Array.prototype.indexOf.call(r,e)},DynamicAdapt.prototype.arraySort=function(t){"min"===this.type?Array.prototype.sort.call(t,(function(t,e){return t.breakpoint===e.breakpoint?t.place===e.place?0:"first"===t.place||"last"===e.place?-1:"last"===t.place||"first"===e.place?1:t.place-e.place:t.breakpoint-e.breakpoint})):Array.prototype.sort.call(t,(function(t,e){return t.breakpoint===e.breakpoint?t.place===e.place?0:"first"===t.place||"last"===e.place?1:"last"===t.place||"first"===e.place?-1:e.place-t.place:e.breakpoint-t.breakpoint}))};const da=new DynamicAdapt("max");da.init();const productsBtn=document.querySelectorAll(".product__btn"),cartProductsList=document.querySelector(".cart__list"),cart=document.querySelector(".cart__wrapper"),cartQuantity=cart.querySelector(".cart__quantity-numb"),cartQuantityWord=cart.querySelector(".cart__word"),fullPrice=document.querySelector(".sum");let price=0;const priceWithoutSpaces=t=>t.replace(/\s/g,""),normalPrice=t=>String(t).replace(/(\d)(?=(\d\d\d)+([^\d]|$))/g,"$1 "),plusFullPrice=t=>price+=t,minusFullPrice=t=>price-=t,printQuantity=()=>{let t=cartProductsList.children.length;cartQuantity.textContent=t,0==t?(cartQuantityWord.textContent=" товара",cartQuantity.textContent="нет"):1==t?cartQuantityWord.textContent=" товар":t<5&&t>1?cartQuantityWord.textContent=" товара":t>=5&&(cartQuantityWord.textContent=" товаров"),t>0?navCart.classList.add("filled"):cart.classList.remove("filled")},printFullPrice=()=>{fullPrice.textContent=normalPrice(price)+" ₴"},generateCartProduct=(t,e,r,a)=>`\n\t\t<li class="cart__item">\n\t\t\t<article class="c-item" data-id="${a}">\n\t\t\t\t<img src="${t}" alt="${e}" class="c-item__image">\n\t\t\t\t<div href="item.html" class="c-item__link">\n\t\t\t\t\t<h4 class="c-item__title">${e}</h4>\n\t\t\t\t\t<span class="c-item__price">${normalPrice(r)}</span>\n\t\t\t\t</div>\n\t\t\t\t<button class="c-item__delete" aria-label="Удалить товар">\n\t\t\t\t×\n\t\t\t\t</button>\n\t\t\t</article>\n\t\t</li>\n\t`,deleteProducts=t=>{let e=t.querySelector(".c-item").dataset.id;document.querySelector(`.product__item[data-id="${e}"]`)&&(console.log("Товар удален с localStorage"),document.querySelector(`.product__item[data-id="${e}"]`).querySelector(".product__btn").disabled=!1);let r=parseInt(priceWithoutSpaces(t.querySelector(".c-item__price").textContent));minusFullPrice(r),printFullPrice(),t.remove(),printQuantity(),updateStorage()};productsBtn.forEach(t=>{t.addEventListener("click",t=>{let e=t.currentTarget,r=e.closest(".product__item"),a=r.dataset.id;if(0==cartProductsList.querySelectorAll(`.c-item[data-id="${a}"]`).length){let t=r.querySelector(".product__image--first").getAttribute("src"),c=r.querySelector(".product__name").textContent,n=priceWithoutSpaces(r.querySelector(".product__price").textContent),i=parseInt(priceWithoutSpaces(r.querySelector(".product__price").textContent));price+=i,printFullPrice(),cartProductsList.insertAdjacentHTML("afterbegin",generateCartProduct(t,c,n,a)),printQuantity(),updateStorage(),e.disabled=!0}else{console.log("Alredy exist");let t=document.getElementById("snackbar-cart");t.className="show",setTimeout((function(){t.className=t.className.replace("show","")}),3e3)}})}),cartProductsList.addEventListener("click",t=>{if(t.target.classList.contains("c-item__delete")){deleteProducts(t.target.closest(".cart__item")),cartProductsList.children.length>0?navCart.classList.add("filled"):navCart.classList.remove("filled")}});const countSum=()=>{document.querySelectorAll(".c-item").forEach(t=>{price+=parseInt(priceWithoutSpaces(t.querySelector(".c-item__price").textContent))})},initialState=()=>{null!==localStorage.getItem("products")&&(cartProductsList.innerHTML=localStorage.getItem("products"),printQuantity(),document.querySelectorAll(".c-item").forEach(t=>{price+=parseInt(priceWithoutSpaces(t.querySelector(".c-item__price").textContent))}),printFullPrice(),document.querySelectorAll(".c-item").forEach(t=>{let e=t.dataset.id;document.querySelector(`.product__item[data-id="${e}"]`)&&(console.log("Товары загрузились с localStarage. Кнопка добавления была отключена, так как товар уже в корзине!"),document.querySelector(`.product__item[data-id="${e}"]`).querySelector(".product__btn").disabled=!0)}))};null!==localStorage.getItem("products")&&(cartProductsList.innerHTML=localStorage.getItem("products"),printQuantity(),document.querySelectorAll(".c-item").forEach(t=>{price+=parseInt(priceWithoutSpaces(t.querySelector(".c-item__price").textContent))}),printFullPrice(),document.querySelectorAll(".c-item").forEach(t=>{let e=t.dataset.id;document.querySelector(`.product__item[data-id="${e}"]`)&&(console.log("Товары загрузились с localStarage. Кнопка добавления была отключена, так как товар уже в корзине!"),document.querySelector(`.product__item[data-id="${e}"]`).querySelector(".product__btn").disabled=!0)}));const updateStorage=()=>{let t=cartProductsList.innerHTML;t=t.trim(),t.length?localStorage.setItem("products",t):(localStorage.removeItem("products"),navCart.classList.remove("filled"))},cartCloseFieldBtn=document.querySelector(".cart__close-field"),cartContent=document.querySelector(".cart");function cartOpen(){navBurger.classList.contains("active")?setTimeout(()=>{cartContent.classList.toggle("active")},10):mediaQuery.matches?mediaQuery.matches&&(setTimeout(()=>{navCart.classList.toggle("active"),cartContent.classList.toggle("active")},10),body.classList.toggle("lock")):(body.classList.remove("lock"),setTimeout(()=>{navCart.classList.toggle("active"),cartContent.classList.toggle("active")},10)),1==navBurger.disabled?navBurger.disabled=!1:navBurger.disabled=!0}navCart.addEventListener("click",()=>{cartOpen()}),cartCloseFieldBtn.addEventListener("click",()=>{cartOpen()});const isiPhone=null!=navigator.userAgent.match(/iPhone/i),isiPad=null!=navigator.userAgent.match(/iPad/i),isiPod=null!=navigator.userAgent.match(/iPod/i);if(isiPhone||isiPad||isiPod){let e=document.querySelectorAll('[href^="#"]'),r=.2;for(let a=0;a<e.length;a++)e[a].addEventListener("click",(function(e){e.preventDefault();let a=window.pageYOffset,c=this.href.replace(/[^#]*(.*)/,"$1");t=document.querySelector(c).getBoundingClientRect().top,start=null,requestAnimationFrame((function e(n){null===start&&(start=n);let i=n-start,o=t<0?Math.max(a-i/r,a+t):Math.min(a+i/r,a+t);window.scrollTo(0,o),o!=a+t?requestAnimationFrame(e):location.hash=c}))}),!1)}const nav=document.querySelector(".nav"),menuWrapper=document.querySelector(".menu__wrapper"),cartWrapper=document.querySelector(".cart__wrapper");let prevScrollpos=window.pageYOffset;function navOpen(){0!=prevScrollpos?(nav.classList.add("nav--active"),menuWrapper.classList.add("menu__wrapper--onscroll"),cartWrapper.classList.add("cart__wrapper--onscroll")):(nav.classList.remove("nav--active"),menuWrapper.classList.remove("menu__wrapper--onscroll"),cartWrapper.classList.remove("cart__wrapper--onscroll"))}function navScroll(){window.onscroll=function(){let t=window.pageYOffset;prevScrollpos<t||(prevScrollpos=t)?(nav.classList.add("nav--active"),menuWrapper.classList.add("menu__wrapper--onscroll"),cartWrapper.classList.add("cart__wrapper--onscroll")):(nav.classList.remove("nav--active"),menuWrapper.classList.remove("menu__wrapper--onscroll"),cartWrapper.classList.remove("cart__wrapper--onscroll")),prevScrollpos=t}}navOpen(),navScroll(),document.querySelectorAll(".acordion-triger").forEach(t=>t.addEventListener("click",()=>{t.parentNode.classList.toggle("acordion--active")}));