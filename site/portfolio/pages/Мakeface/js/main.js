const popupLinks=document.querySelectorAll(".popup-link"),lockPadding=document.querySelectorAll(".lock-padding"),body=document.querySelector("body");let unlock=!0;const timeout=800,popupCloseIcon=document.querySelectorAll(".close-popup");let currentCloseBtn,previousActiveElement;function includeTitle(e){let t;t=e.target.closest(".t-item").querySelector(".t-item__heading").textContent,document.querySelector(".popup__title").textContent=t}if(popupLinks.length>0)for(let e=0;e<popupLinks.length;e++){const t=popupLinks[e];t.addEventListener("click",(function(e){const o=t.dataset.path;popupOpen(document.getElementById(o)),setTimeout(()=>{popupCloseIcon.forEach(e=>{e.focus()})},100),includeTitle(e),e.preventDefault()}))}if(popupCloseIcon.length>0)for(let e=0;e<popupCloseIcon.length;e++){const t=popupCloseIcon[e];currentCloseBtn=t,t.addEventListener("click",(function(e){popupClose(t.closest(".popup")),e.preventDefault()}))}function popupOpen(e){if(e&&unlock){previousActiveElement=document.activeElement;const t=document.querySelector(".popup.open");t?popupClose(t,!1):bodyLock(),e.classList.add("open"),e.addEventListener("mousedown",(function(e){e.target.closest(".popup__content")||popupClose(e.target.closest(".popup"))}))}}function popupClose(e,t=!0){unlock&&(e.classList.remove("open"),t&&bodyUnlock()),previousActiveElement.focus()}function bodyLock(){const e=window.innerWidth-document.querySelector(".wrapper").offsetWidth+"px";if(lockPadding.length>0)for(let t=0;t<lockPadding.length;t++){lockPadding[t].style.paddingRight=e}body.style.paddingRight=e,body.classList.add("lock"),unlock=!1,setTimeout((function(){unlock=!0}),800)}function bodyUnlock(){setTimeout((function(){if(lockPadding.length>0)for(let e=0;e<lockPadding.length;e++){lockPadding[e].style.paddingRight="0px"}body.style.paddingRight="0px",body.classList.remove("lock")}),800)}if(document.addEventListener("keydown",(function(e){if(27===e.which){popupClose(document.querySelector(".popup.open"))}})),Element.prototype.closest||(Element.prototype.closest=function(e){for(var t=this;t;){if(t.matches(e))return t;t=t.parentElement}return null}),Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.webkitMatchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector),AOS.init({disable:"mobile"}),navigator.userAgent.indexOf("Edge")>-1){document.querySelector(".promo__container").style.flex="0 0 auto"}const wrapper=document.querySelector(".wrapper"),headerBurger=document.querySelector(".header__burger"),headerMenu=document.querySelector(".header__menu"),headerLink=document.querySelectorAll(".header__link"),md2=window.matchMedia("(max-width: 767px)");function burgerToggle(){headerBurger.classList.toggle("active"),headerMenu.classList.toggle("active"),body.classList.toggle("lock")}headerBurger.addEventListener("click",()=>{burgerToggle()}),md2.matches&&headerLink.forEach(e=>{e.addEventListener("click",()=>{setTimeout(()=>{burgerToggle()},300)})});const isiPhone=null!=navigator.userAgent.match(/iPhone/i),isiPad=null!=navigator.userAgent.match(/iPad/i),isiPod=null!=navigator.userAgent.match(/iPod/i);if(isiPhone||isiPad||isiPod||navigator.userAgent.indexOf("Edge")>-1){let e=document.querySelectorAll('[href^="#"]'),o=.2;for(let n=0;n<e.length;n++)e[n].addEventListener("click",(function(e){e.preventDefault();let n=window.pageYOffset,r=this.href.replace(/[^#]*(.*)/,"$1");t=document.querySelector(r).getBoundingClientRect().top,start=null,requestAnimationFrame((function e(c){null===start&&(start=c);let a=c-start,l=t<0?Math.max(n-a/o,n+t):Math.min(n+a/o,n+t);window.scrollTo(0,l),l!=n+t?requestAnimationFrame(e):location.hash=r}))}),!1)}const header=document.querySelector(".header");let prevScrollpos=window.pageYOffset;function navOpen(){0!=prevScrollpos?(header.classList.add("header--active"),headerMenu.classList.add("menu--onscroll")):(header.classList.remove("header--active"),headerMenu.classList.remove("menu--onscroll"))}function navScroll(){window.onscroll=function(){let e=window.pageYOffset;prevScrollpos<e||(prevScrollpos=e)?(header.classList.add("header--active"),headerMenu.classList.add("menu--onscroll")):(header.classList.remove("header--active"),headerMenu.classList.remove("menu--onscroll")),prevScrollpos=e}}navOpen(),navScroll(),document.querySelectorAll(".accordion-triger").forEach(e=>e.addEventListener("click",()=>{e.parentNode.classList.toggle("accordion--active");let t=e.parentNode.querySelector(".accordion__body");e.parentNode.classList.contains("accordion--active")?(e.parentNode.querySelector(".accordion-triger").setAttribute("aria-expanded",!0),t.setAttribute("aria-hidden",!1),t.style.maxHeight=t.scrollHeight+"px"):(e.parentNode.querySelector(".accordion-triger").setAttribute("aria-expanded",!1),t.setAttribute("aria-hidden",!0),t.style.maxHeight=null)})),window.addEventListener("scroll",()=>{let e=window.scrollY;window.innerWidth>768&&document.querySelectorAll(".section").forEach((t,o)=>{t.offsetTop-document.querySelector(".header").clientHeight<=e&&(document.querySelectorAll(".header__list a").forEach(e=>{e.classList.contains("active")&&e.classList.remove("active")}),document.querySelectorAll(".header__list li")[o].querySelector("a").classList.add("active"))})});const snackbarBtn=document.querySelector(".snackbar-btn"),snackbar=document.querySelector(".snackbar");function snackbarShow(e,t,o,n){snackbar.innerHTML=""+e,snackbarBtn.disabled=!0,(null==o||"auto"==o)&&(o=3e3),null==n&&(n=0),setTimeout(()=>{0==t?(snackbar.removeAttribute("hidden"),snackbar.classList.add("show-notification"),setTimeout((function(){snackbar.className=snackbar.className.replace("show-notification",""),snackbar.setAttribute("hidden","hidden")}),o)):1==t&&(snackbar.removeAttribute("hidden"),snackbar.classList.add("show-attention"),setTimeout((function(){snackbar.className=snackbar.className.replace("show-attention",""),snackbar.setAttribute("hidden","hidden")}),o)),setTimeout(()=>{snackbarBtn.disabled=!1},o)},n)}function ValidMail(){let e=document.querySelector(".form__input--mail").value,t=/^[\w-\.]+@[\w-]+\.[a-z]{2,4}$/i.test(e);return t||snackbarShow("E-mail введен неверно! Проверьте ваши данные!",1),t}function ValidPhone(){let e=document.querySelector(".form__input--tel").value,t=/^\d[\d\(\)\ -]{7,14}\d$/.test(e);return t||snackbarShow("Номер телефона введен неверно! Проверьте ваши данные!",1),t}document.querySelector(".form").addEventListener("submit",e=>{e.preventDefault();let t=e.currentTarget,o=new FormData(t),n=t.querySelector('[name="Имя"]').value,r=t.querySelector('[name="E-mail"]').value,c=t.querySelector('[name="Номер телефона"]').value;o.append("Имя",n),o.append("Номер телефона",c),o.append("E-mail",r);let a=new XMLHttpRequest;a.onreadystatechange=function(){4===a.readyState&&(200===a.status?(console.log("Отправлено"),snackbarShow("Покупка оформленна! В скором времени я с вами свяжусь!",0,"auto",1e3),popupClose(currentCloseBtn.closest(".popup")),previousActiveElement.focus()):(snackbarShow("Вы все сделали правильно! Извините, отправка заявок недоступна!",1,"auto",1e3),popupClose(currentCloseBtn.closest(".popup")),previousActiveElement.focus()))},a.open("POST","/resources/mail.php",!0),ValidPhone()&&ValidMail()?(a.send(o),t.reset()):0==ValidMail()?document.querySelector(".form__input--mail").focus():0==ValidPhone()&&document.querySelector(".form__input--tel").focus()});